We‚Äôre enhancing the Ambersand compliance platform with the following features. Please update the backend (FastAPI + PostgreSQL) and frontend (React + Tailwind) accordingly, following clean architecture and best practices.

‚∏ª

‚úÖ 1. Tasks Support Multiple Controls (Wizard UI Flow)
	‚Ä¢	Refactor the DB: Replace task.control_id with a many-to-many relationship via a new table task_controls (task_id, control_id).
	‚Ä¢	Update Task Creation Flow:
	‚Ä¢	Step 1: Select multiple controls from the list already assigned to the project.
	‚Ä¢	Step 2: Enter task details (title, description, due date, assignee).
	‚Ä¢	Display selected controls on the task card as pills.

‚∏ª

‚úÖ 2. Project Owner Dropdown & Display
	‚Ä¢	On project creation, add a required Project Owner field (dropdown of all system users).
	‚Ä¢	In the projects table, add owner_id (foreign key to users).
	‚Ä¢	Display the project owner‚Äôs name in each project card.

‚∏ª

‚úÖ 3. Evidence Page with Card/List Toggle
	‚Ä¢	Implement a toggle to view evidence either as:
	‚Ä¢	Card Grid (thumbnail + details), or
	‚Ä¢	List Table (title, uploader, version, actions).
	‚Ä¢	Use a state variable (viewMode = 'card' | 'list') to toggle between views.

‚∏ª

‚úÖ 4. User Assignment in Tasks with Auto-Suggestion
	‚Ä¢	In task creation, use a searchable dropdown (e.g. react-select or HeadlessUI‚Äôs Combobox) for the ‚ÄúAssigned To‚Äù field.
	‚Ä¢	Populate from the users table with auto-suggestion.

‚∏ª

‚úÖ 5. Role-Based Access for Viewers
	‚Ä¢	Define two roles: admin, viewer.
	‚Ä¢	Viewers should only see:
	‚Ä¢	Projects where owner_id = viewer.id
	‚Ä¢	Tasks where assigned_to = viewer.id
	‚Ä¢	Admins can see everything.
	‚Ä¢	Hide all irrelevant pages from viewers (e.g., project creation).

‚∏ª

‚úÖ 6. Evidence Versioning, Upload History & Comments
	‚Ä¢	Add these new tables:
	‚Ä¢	evidence_versions (evidence_id, file_url, uploaded_by, timestamp)
	‚Ä¢	evidence_comments (evidence_id, user_id, comment, created_at)
	‚Ä¢	When uploading evidence again, save as a new version with metadata.
	‚Ä¢	Allow users to add comments on each evidence.
	‚Ä¢	Show version and comment history under each evidence item.

‚∏ª

‚úÖ 7. Evidence Cards Show Related Controls & Tasks
	‚Ä¢	Add many-to-many tables:
	‚Ä¢	evidence_controls (evidence_id, control_id)
	‚Ä¢	evidence_tasks (evidence_id, task_id)
	‚Ä¢	Show all related controls and tasks on the evidence card.
	‚Ä¢	Allow user to assign more controls to existing evidence from the UI.

‚∏ª

üìÅ Suggested File Updates:
	‚Ä¢	models/task_controls.py, models/evidence_versions.py
	‚Ä¢	routes/tasks.py, routes/evidence.py
	‚Ä¢	components/tasks/TaskWizard.tsx
	‚Ä¢	components/evidence/EvidenceCard.tsx, EvidenceListRow.tsx
	‚Ä¢	components/projects/ProjectOwnerSelector.tsx
	‚Ä¢	utils/permissions.ts
